{% extends 'server/master.html' %}
{% load static %}
{% block page_content %}
<div class="prod">
    {% for object in object_list %}
    {% include 'server/product.html' with id=object.pk name=object.name description=object.description cost=object.cost %}
    {% endfor %}
</div>
{% if page_obj.has_next %}
<button class="show-more-button">Show more</button>
{% endif %}

    {% include 'server/pagination.html' with page=page_obj page_range=paginator.page_range %}




<div class="container">
    <div class="header2">
        <a href="/"><img class="logo" src="/static/img/logo.png" alt="logo"></a>
        <ul class="menu">
            <li><a href="/">HOME</a></li>
            <li><a href="/products/">PRODUCTS</a></li>
            <li><a href="#">HISTORY</a></li>
            <li><a href="#">SHOWROOM</a></li>
            <li><a href="/contact/">CONTACTS</a></li>
        </ul>
        <div class="opr"><h1>Our Products Range</h1></div>
    </div>
    <div class="featured2">
        <ul>
            <li>All</li>
            <li>Home</li>
            <li>Office</li>
            <li>Furniture</li>
            <li>Modern</li>
            <li>Classic</li>
        </ul>
    </div>
    <div class="row_1_2">
        <a href="/product_details/"><img src="/static/img/product-5.jpg" alt=""></a>
        <a href="/product_details/"><img src="/static/img/product-6.jpg" alt=""></a>
        <a href="/product_details/"><img src="/static/img/product-7.jpg" alt=""></a>
    </div>
    <div class="row_2_2">
        <a href="/product_details/"><img src="/static/img/product-8.jpg" alt=""></a>
        <a href="/product_details/"><img src="/static/img/product-9.jpg" alt=""></a>
        <a href="/product_details/"><img src="/static/img/product-10.jpg" alt=""></a>
    </div>
    <div class="row_1_2">
        <a href="/product_details/"><img src="/static/img/product-5.jpg" alt=""></a>
        <a href="/product_details/"><img src="/static/img/product-6.jpg" alt=""></a>
        <a href="/product_details/"><img src="/static/img/product-7.jpg" alt=""></a>
    </div>
    <div class="row_2_2">
        <a href="/product_details/"><img src="/static/img/product-8.jpg" alt=""></a>
        <a href="/product_details/"><img src="/static/img/product-9.jpg" alt=""></a>
        <a href="/product_details/"><img src="/static/img/product-10.jpg" alt=""></a>
    </div>
    <div class="clear"></div>
    <div class="marg"></div>
    <img src="/static/img/load.png" alt="load" class="load">
    <div class="promo">
        <div class="promo_1">
            <h3>Exclusive</h3>
            <h2>Fishnet Chair</h2>
            <p>Seat and back with upholstery made of cold cure foam.<br>Steel frame, available in matt powder-coated black or highly polished chrome.</p>
            <a class="button" href="/product_details/">Order US</a>
        </div>
        <div class="promo_2">
            <h3>Exclusive</h3>
            <h2>Fishnet Chair</h2>
            <p>Seat and back with upholstery made of cold cure foam.<br>Steel frame, available in matt powder-coated black or highly polished chrome.</p>
            <a class="button" href="/product_details/">Order US</a>
        </div>
    </div>
</div>
{% endblock %}

{% block page_js %}
<script src="{% static 'products/js/products.js' %}"></script>
<script>
    const products = document.querySelector('.prod');
    const showMoreButton = document.querySelector('.show-more-button');
    let productsUrl = '{% url "rest_products:list" %}?page={% if page_obj.has_next %}{{ page.obj.next_page_number }}{% endif %}'

    const showMore = () => {
        fetch(productsUrl)
            .then(response => response.json())
            .then(
                data => {
                    data.results.map(
                        itm => products.innerHTML += renderProduct(itm)
                    )
                    if (data.next_url) {
                        productsUrl = data.next_url
                    } else {
                        showMoreButton.classList.add('show-more-button_hidden')
                    }
                }
            )
    }

    showMoreButton.addEventListener('click', showMore);


</script>
{% endblock %}